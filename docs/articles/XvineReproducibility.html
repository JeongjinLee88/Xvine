<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Xvine">
<title>XvineReproducibility • Xvine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="XvineReproducibility">
<meta property="og:description" content="Xvine">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Xvine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/XvineFlightDelays.html">XvineFlightDelays</a>
    <a class="dropdown-item" href="../articles/XvineReproducibility.html">XvineReproducibility</a>
    <a class="dropdown-item" href="../articles/XvineWorkflow.html">XvineWorkflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JeongjinLee88/Xvine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>XvineReproducibility</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JeongjinLee88/Xvine/blob/HEAD/vignettes/XvineReproducibility.Rmd" class="external-link"><code>vignettes/XvineReproducibility.Rmd</code></a></small>
      <div class="d-none name"><code>XvineReproducibility.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="load-required-packages-">1. Load required packages.<a class="anchor" aria-label="anchor" href="#load-required-packages-"></a>
</h3>
<p>The X-Vine package requires other packages: <code>VineCopula</code>
and <code>graphicalExtremes</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JeongjinLee88/Xvine" class="external-link">Xvine</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tnagler/VineCopula" class="external-link">VineCopula</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="x-vine-specification-">2. X-Vine specification.<a class="anchor" aria-label="anchor" href="#x-vine-specification-"></a>
</h3>
<p><code><a href="../reference/XVineSpec.html">XVineSpec()</a></code> function specifies the X-Vine specification
<span class="math inline">\((\mathcal{V},\mathcal{R},\mathcal{C})\)</span>;
vine tree structure matrix, family matrix for bivariate parametric
(tail) copula families, and the associated parameter matrix.</p>
</div>
<div class="section level3">
<h3 id="create-box-plots-of-parameter-estimates-for-x-vine-models-">3. Create box-plots of parameter estimates for X-vine models.<a class="anchor" aria-label="anchor" href="#create-box-plots-of-parameter-estimates-for-x-vine-models-"></a>
</h3>
<p>This section is to reproduce Fig 3. (a) and (b), and Fig7.</p>
<p>Given the X-Vine structure and selected bivariate parametric
families, we draw multivariate (generalized) Pareto samples of size
<span class="math inline">\(N=4000\)</span> and set a threshold <span class="math inline">\(k/n=0.05\)</span> of the uniform margin <span class="math inline">\(\widehat{U}_{i,j}\)</span> Instead of using these
Pareto samples directly, we perform a rank transformation and take
sub-samples to investigate results with respect to threshold
exceedances. We obtain ML estimates under 200 repeated iterations. We
also convert the ML estimates to dependence measure coefficients: the
tail dependence coefficient for <span class="math inline">\(e\in
E_1\)</span> and Kendall’s tau for <span class="math inline">\(e\in
E_i\)</span>, <span class="math inline">\(i&gt;1\)</span> using the
parametric relationships. Fig 3. (a) shows box-plots of dependence
measure estimates from specified bivairate parametric families. Varying
<span class="math inline">\((n,k)\)</span>, we can reproduce box-plots
in Fig. 7. For Fig 3. (b), bivariate parametric (tail) families are
selected sequentially from the data along the vine tree sequence.</p>
<div class="section level4">
<h4 id="box-plots-of-ml-estimates-for-the-tail-copula-density-linked-to-a-specific-edge-">4. Box-plots of ML estimates for the tail copula density linked to a
specific edge.<a class="anchor" aria-label="anchor" href="#box-plots-of-ml-estimates-for-the-tail-copula-density-linked-to-a-specific-edge-"></a>
</h4>
<p>This section is to reproduce Fig 8. <code><a href="../reference/XVineBoxplot.html">XVineBoxplot()</a></code>
creates box-plots of parameter estimates for a parameter (<span class="math inline">\(\Gamma\)</span> or <span class="math inline">\(\theta\)</span>, etc.) corresponding a specific
edge. In Fig 8., we consider the box-plots of ML estimates for the
Hűsler-Reiss tail copula density linked to the edge <span class="math inline">\(e=\{1,2\}\in E_1\)</span>, using different <span class="math inline">\((n,k)\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># n = 1000, 2000, 4000 / k/n = 0.02, 0.05, 0.1</span></span>
<span><span class="va">ite</span><span class="op">=</span><span class="fl">200</span></span>
<span><span class="va">BoxOut1K02</span><span class="op">=</span><span class="fu"><a href="../reference/XVineBoxplot.html">XVineBoxplot</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, qt <span class="op">=</span> <span class="fl">0.02</span>, ite <span class="op">=</span> <span class="va">ite</span>, XVS <span class="op">=</span> <span class="va">XVS</span>, RankT <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">BoxOut1K05</span><span class="op">=</span><span class="fu"><a href="../reference/XVineBoxplot.html">XVineBoxplot</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, qt <span class="op">=</span> <span class="fl">0.05</span>, ite <span class="op">=</span> <span class="va">ite</span>, XVS <span class="op">=</span> <span class="va">XVS</span>, RankT <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">BoxOut1K1</span><span class="op">=</span><span class="fu"><a href="../reference/XVineBoxplot.html">XVineBoxplot</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, qt <span class="op">=</span> <span class="fl">0.1</span>, ite <span class="op">=</span> <span class="va">ite</span>, XVS <span class="op">=</span> <span class="va">XVS</span>, RankT <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BoxPar1K</span><span class="op">=</span><span class="fu"><a href="../reference/XVineBoxPlotEachPar.html">XVineBoxPlotEachPar</a></span><span class="op">(</span>BoxOut1 <span class="op">=</span> <span class="va">BoxOut1K02</span><span class="op">$</span><span class="va">MLE_WithoutFamSel</span>,BoxOut2 <span class="op">=</span> <span class="va">BoxOut1K05</span><span class="op">$</span><span class="va">MLE_WithoutFamSel</span>,BoxOut3 <span class="op">=</span> <span class="va">BoxOut1K1</span><span class="op">$</span><span class="va">MLE_WithoutFamSel</span>,</span>
<span>                             RowInd <span class="op">=</span> <span class="fl">1</span>,ColInd <span class="op">=</span> <span class="fl">2</span>,XVS <span class="op">=</span> <span class="va">XVS</span><span class="op">)</span></span>
<span><span class="va">BoxPar1K</span><span class="op">$</span><span class="va">BoxOnePar</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">""</span>,x<span class="op">=</span><span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k=20"</span>,<span class="st">"k=50"</span>,<span class="st">"k=100"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="simulation-for-the-selection-of-bivariate-parametric-families">5. Simulation for the selection of bivariate parametric
families<a class="anchor" aria-label="anchor" href="#simulation-for-the-selection-of-bivariate-parametric-families"></a>
</h4>
<p>This section is to reproduce Table 1. (a) and (b).
<code><a href="../reference/XVineFamSelSimul.html">XVineFamSelSimul()</a></code> returns simulation results of selecting
bivariate parametric families by calling the function
<code><a href="../reference/XVineFamSel.html">XVineFamSel()</a></code>. All information about the simulation result
is saved in the list of <code>FamSelOut</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time difference of 1.115222 mins</span></span>
<span><span class="va">FamSelOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/XVineFamSelSimul.html">XVineFamSelSimul</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">4000</span>, qt <span class="op">=</span> <span class="fl">0.05</span>, ite <span class="op">=</span> <span class="fl">200</span>, XVS <span class="op">=</span> <span class="va">XVS</span></span>
<span> ,edgeIndex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>, familyset_tc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, familyset_cop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FamSelOut</span><span class="op">$</span><span class="va">EdgeProp</span></span>
<span><span class="va">FamSelOut</span><span class="op">$</span><span class="va">EffSizePercent</span></span>
<span><span class="va">FamSelOut</span><span class="op">$</span><span class="va">GlobalProp</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="dimensional-x-vine-specification">5. 50 dimensional X-vine specification<a class="anchor" aria-label="anchor" href="#dimensional-x-vine-specification"></a>
</h3>
<p>Now, we consider a 50-dimensional C-vine where the first tree
includes the Hűsler–Reiss models and negative logistic models with
randomly assigned parameter values <span class="math inline">\(\theta_e
\in [1, 2]\)</span> for <span class="math inline">\(e \in E_1\)</span>.
Subsequent trees contain bivariate Gaussian copulas with partial
correlations <span class="math inline">\(\rho_e = 1.1 − 0.1j\)</span>
for <span class="math inline">\(e \in E_j\)</span> and <span class="math inline">\(j \in \{2, . . . , 9\}\)</span>, and <span class="math inline">\(\rho_e = 0.1\)</span> for <span class="math inline">\(e \in E_j\)</span> with <span class="math inline">\(j \ge 10\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dim</span><span class="op">=</span><span class="fl">50</span></span>
<span><span class="va">StrMtx</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow <span class="op">=</span> <span class="va">Dim</span>,ncol <span class="op">=</span> <span class="va">Dim</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">i</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">StrMtx</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="va">i</span> <span class="co"># C-vine</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1220</span><span class="op">)</span></span>
<span><span class="va">FamMtx</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">Dim</span>,<span class="va">Dim</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">i</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">FamMtx</span><span class="op">[</span><span class="fl">1</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,size <span class="op">=</span> <span class="fl">1</span>,replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># assign randomly HR and NL in T1</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">FamMtx</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> <span class="co"># assign all Gaussian copulas in Ti, i&gt;1</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">FamMtx</span><span class="op">)</span><span class="op">=</span><span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1220</span><span class="op">)</span></span>
<span><span class="va">ParMtx</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow <span class="op">=</span> <span class="va">Dim</span>,ncol <span class="op">=</span> <span class="va">Dim</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">i</span><span class="op">:</span><span class="va">Dim</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">ParMtx</span><span class="op">[</span><span class="fl">1</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>  <span class="co"># Parameter values on (1,2)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fl">1</span> <span class="op">&lt;</span> <span class="va">i</span> <span class="op">&amp;</span> <span class="va">i</span> <span class="op">&lt;=</span> <span class="fl">9</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">ParMtx</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fl">1.1</span><span class="op">-</span><span class="fl">0.1</span><span class="op">*</span><span class="va">i</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">9</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">ParMtx</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">=</span><span class="fl">0.1</span> <span class="co"># same partial correlation 0.5 for Ti</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ParMtx</span><span class="op">)</span><span class="op">=</span><span class="fl">0</span></span>
<span><span class="co">##  X-Vine specification (Vine structure, Bivariate parametric families, Parameters)</span></span>
<span><span class="co"># Time difference of 1.115222 mins</span></span>
<span><span class="va">XVS</span><span class="op">=</span><span class="fu"><a href="../reference/XVineSpec.html">XVineSpec</a></span><span class="op">(</span>M <span class="op">=</span> <span class="va">StrMtx</span>, Mmod <span class="op">=</span> <span class="va">FamMtx</span>, Mpar <span class="op">=</span> <span class="va">ParMtx</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fitting-x-vine-models-">6. Fitting X-vine models.<a class="anchor" aria-label="anchor" href="#fitting-x-vine-models-"></a>
</h3>
<p>This section is to reproduce Fig 4. Now, we estimate all three
components of the X-vine specification <span class="math inline">\((\mathcal{V},\mathcal{R},\mathcal{C})\)</span>. We
draw multivariate Pareto samples of size <span class="math inline">\(n=1\,000\)</span>. Using the (lower) tail
dependence coefficient <span class="math inline">\(\hat{\chi}_e\)</span>
for <span class="math inline">\(e\in E_1\)</span> as edge weight and the
Kendall’s tau <span class="math inline">\(\hat{\tau}_e\)</span> for
<span class="math inline">\(e\in E_i\)</span>, <span class="math inline">\(i\ge 2\)</span>, we first estimate the vine tree
sequence sequentially from <span class="math inline">\(T_1\)</span> to
<span class="math inline">\(T_{d-1}\)</span> that satisfies the
proximity condition. For the purpose of capturing as much extremal
dependence as possible in the first several trees, we find maximum
spanning trees. After the vine tree sequence is selected, we choose
bivariate parametric families for each edge in each tree and estimate
the associated parameter(s). Fig 4. (a) The mBIC plotted across tree
levels with a dotted line indicating the selected mBIC-optimal
truncation level of <span class="math inline">\(q^∗ = 19\)</span>. Fig
4. (b) <span class="math inline">\(\chi\)</span>-plot comparing pairwise
<span class="math inline">\(\chi\)</span> values from the specified
X-vine model to those obtained from the fitted X-vine model via Monte
Carlo simulations. Fig 4. (c) <span class="math inline">\(\chi\)</span>-plot for the truncated X-vine
model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 'XVinePa50dim.Rdata' is included in the Xvine package.</span></span>
<span><span class="co"># Time difference of 7.086743 mins</span></span>
<span><span class="co">#set.seed(1953)</span></span>
<span><span class="co">#XVinePa50dim=ParetoSim(n = 1000, XVS = XVS) # Pareto scale</span></span>
<span></span>
<span><span class="co">#Time difference of 26.23817 mins</span></span>
<span><span class="va">XVineFitOut</span><span class="op">=</span><span class="fu"><a href="../reference/XVineModelFit.html">XVineModelFit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">XVinePa50dim</span>, N <span class="op">=</span> <span class="fl">5000</span>, XVS <span class="op">=</span> <span class="va">XVS</span></span>
<span>          , Rank <span class="op">=</span> <span class="cn">FALSE</span>, Rank_chiL <span class="op">=</span> <span class="cn">FALSE</span>, Rank_chi3 <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>          , Chi3_graph <span class="op">=</span> <span class="cn">FALSE</span>, Rank_Vario <span class="op">=</span> <span class="cn">FALSE</span>, Vario_graph <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>          , tcfamset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, pcfamset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span><span class="op">)</span></span>
<span>          , selectioncrit <span class="op">=</span> <span class="st">"AIC"</span>, trunclevel <span class="op">=</span> <span class="cn">FALSE</span>, progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>          , treecritT1 <span class="op">=</span> <span class="st">"chi"</span>, treecritT2 <span class="op">=</span> <span class="st">"tau"</span>, effsampsize <span class="op">=</span> <span class="fl">10</span></span>
<span>          , tau_threshold <span class="op">=</span> <span class="fl">0.05</span>, weights <span class="op">=</span> <span class="cn">NA</span>, cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">XVineFitOut</span><span class="op">$</span><span class="va">mBIC_g</span></span>
<span><span class="va">XVineFitOut</span><span class="op">$</span><span class="va">ChiLPlot</span></span>
<span></span>
<span></span>
<span><span class="va">XVineTrunOut</span><span class="op">=</span><span class="fu"><a href="../reference/XVineModelFit.html">XVineModelFit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">XVinePa50dim</span>, N <span class="op">=</span> <span class="fl">5000</span>, XVS <span class="op">=</span> <span class="va">XVS</span></span>
<span>          , Rank <span class="op">=</span> <span class="cn">FALSE</span>, Rank_chiL <span class="op">=</span> <span class="cn">FALSE</span>, Rank_chi3 <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>          , Chi3_graph <span class="op">=</span> <span class="cn">FALSE</span>, Rank_Vario <span class="op">=</span> <span class="cn">FALSE</span>, Vario_graph <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>          , tcfamset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, pcfamset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span><span class="op">)</span></span>
<span>          , selectioncrit <span class="op">=</span> <span class="st">"AIC"</span>, trunclevel <span class="op">=</span> <span class="fl">19</span>, progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>          , treecritT1 <span class="op">=</span> <span class="st">"chi"</span>, treecritT2 <span class="op">=</span> <span class="st">"tau"</span>, effsampsize <span class="op">=</span> <span class="fl">10</span></span>
<span>          , tau_threshold <span class="op">=</span> <span class="fl">0.05</span>, weights <span class="op">=</span> <span class="cn">NA</span>, cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Time difference of 18.49413 mins</span></span>
<span><span class="va">XVineTrunOut</span><span class="op">$</span><span class="va">ChiLPlot</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">XVineFitOut</span><span class="op">$</span><span class="va">ChiLPlot</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">XVineTrunOut</span><span class="op">$</span><span class="va">ChiLPlot</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span>,limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">XVineFitOut</span><span class="op">$</span><span class="va">mBIC_g</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeongjin Lee, Anna Kiriliouk, Johan Segers.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
