<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Assuming that the vine structure is given, XVineFamSel chooses bivariate parametric families for each edge in each tree.
Specifically, in \(T_1\), we consider the list of four candidate bivariate tail copula densities: the H\(\&quot;{u}\)sler-Reiss exponent measure, negative logistic model, logistic model, and Dirichlet model.
Similarly, we consider any type of bivariate pair-copula families with a single parameter in \(T_i\), \(i\ge 2\).
(e.g. 0=Independence, 1=Gaussian, 3=Clayton, 4=Gumbel, 5=Frank, 6=Joe, 13=Survival Clayton, 14=Survival Gumbel, 16=Survival Joe)
We use the AIC for model selection and select the bivariate (tail) copula density families with the lowest AIC value for each edge in each tree sequentially.
Besides the AIC, we use two additional criteria to set bivariate parametric copulas to independence copulas: the effective sample size falls below 10 (\(n_{D_e} &amp;lt; 10\))
or the empirical Kendall's tau is less than 0.05 (\(\hat{\tau} &amp;lt; 0.05\)) for each edge \(e\in E_i\), \(i=2,\ldots,d-1\).
After that, the algorithm estimates the associated parameter(s) for the selected copula family.
For more details on the selection of bivariate parametric families along the vine tree sequence, refer to Kiriliouk, A., Lee, J., &amp;amp; Segers, J. (2023)."><title>Model selection for bivariate parametric families along a vine structure — XVineFamSel • Xvine</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model selection for bivariate parametric families along a vine structure — XVineFamSel"><meta property="og:description" content="Assuming that the vine structure is given, XVineFamSel chooses bivariate parametric families for each edge in each tree.
Specifically, in \(T_1\), we consider the list of four candidate bivariate tail copula densities: the H\(\&quot;{u}\)sler-Reiss exponent measure, negative logistic model, logistic model, and Dirichlet model.
Similarly, we consider any type of bivariate pair-copula families with a single parameter in \(T_i\), \(i\ge 2\).
(e.g. 0=Independence, 1=Gaussian, 3=Clayton, 4=Gumbel, 5=Frank, 6=Joe, 13=Survival Clayton, 14=Survival Gumbel, 16=Survival Joe)
We use the AIC for model selection and select the bivariate (tail) copula density families with the lowest AIC value for each edge in each tree sequentially.
Besides the AIC, we use two additional criteria to set bivariate parametric copulas to independence copulas: the effective sample size falls below 10 (\(n_{D_e} &amp;lt; 10\))
or the empirical Kendall's tau is less than 0.05 (\(\hat{\tau} &amp;lt; 0.05\)) for each edge \(e\in E_i\), \(i=2,\ldots,d-1\).
After that, the algorithm estimates the associated parameter(s) for the selected copula family.
For more details on the selection of bivariate parametric families along the vine tree sequence, refer to Kiriliouk, A., Lee, J., &amp;amp; Segers, J. (2023)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">Xvine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/XvineFlightDelays.html">XvineFlightDelays</a>
    <a class="dropdown-item" href="../articles/XvineReproducibility.html">XvineReproducibility</a>
    <a class="dropdown-item" href="../articles/XvineWorkflow.html">XvineWorkflow</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JeongjinLee88/Xvine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model selection for bivariate parametric families along a vine structure</h1>
      <small class="dont-index">Source: <a href="https://github.com/JeongjinLee88/Xvine/blob/HEAD/R/XVineFamSel.R" class="external-link"><code>R/XVineFamSel.R</code></a></small>
      <div class="d-none name"><code>XVineFamSel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Assuming that the vine structure is given, <code>XVineFamSel</code> chooses bivariate parametric families for each edge in each tree.
Specifically, in \(T_1\), we consider the list of four candidate bivariate tail copula densities: the H\(\"{u}\)sler-Reiss exponent measure, negative logistic model, logistic model, and Dirichlet model.
Similarly, we consider any type of bivariate pair-copula families with a single parameter in \(T_i\), \(i\ge 2\).
(e.g. 0=Independence, 1=Gaussian, 3=Clayton, 4=Gumbel, 5=Frank, 6=Joe, 13=Survival Clayton, 14=Survival Gumbel, 16=Survival Joe)
We use the <code>AIC</code> for model selection and select the bivariate (tail) copula density families with the lowest <code>AIC</code> value for each edge in each tree sequentially.
Besides the <code>AIC</code>, we use two additional criteria to set bivariate parametric copulas to independence copulas: the effective sample size falls below 10 (\(n_{D_e} &lt; 10\))
or the empirical Kendall's tau is less than 0.05 (\(\hat{\tau} &lt; 0.05\)) for each edge \(e\in E_i\), \(i=2,\ldots,d-1\).
After that, the algorithm estimates the associated parameter(s) for the selected copula family.
For more details on the selection of bivariate parametric families along the vine tree sequence, refer to Kiriliouk, A., Lee, J., &amp; Segers, J. (2023).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">XVineFamSel</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  Rank <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  qt <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  <span class="va">XVS</span>,</span>
<span>  <span class="va">famset_tc</span>,</span>
<span>  <span class="va">famset_cop</span>,</span>
<span>  selectioncrit <span class="op">=</span> <span class="st">"AIC"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mle"</span>,</span>
<span>  effsampsize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  tau_threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>An \(n\times d\) data matrix from the inverted Pareto distribution. In this case, <code>Rank=T</code> is not recommended as the rank transformation
does not properly work for the data already on uniform scale.
If either the original data or samples from multivariate Pareto distribution on Pareto scale are used, then <code>Rank=T</code> is required.</p></dd>


<dt>Rank</dt>
<dd><p>Logical; whether rank transformation is performed or not (<code>Rank=T</code>; default).</p></dd>


<dt>qt</dt>
<dd><p>Numeric; a lower enough threshold used in the rank transformation (e.g. switches from Pareto scale to uniform scale)</p></dd>


<dt>XVS</dt>
<dd><p>A list consisting of three components: reconstructed structure matrices, family matrices, parameter matrices, see:<code><a href="XVineSpec.html">XVineSpec()</a></code>.</p></dd>


<dt>famset_tc</dt>
<dd><p>Numeric vector; the model type of bivariate tail copulas.
Possible tail copula models are:</p><ul><li><p>1=Husler-Reiss model</p></li>
<li><p>2=Negative logistic model</p></li>
<li><p>3=Logistic model</p></li>
<li><p>4=Dirichlet model</p></li>
</ul></dd>


<dt>famset_cop</dt>
<dd><p>Numeric vector; the class of bivariate copula families with a single parameter</p></dd>


<dt>selectioncrit</dt>
<dd><p>Character; the information criteria for model selections (default: <code>AIC</code>)</p></dd>


<dt>method</dt>
<dd><p>Character; parameter estimation method (Default; <code>mle</code>)</p></dd>


<dt>effsampsize</dt>
<dd><p>Integer; indicates the effective sample size (Default: 10) for the independence copula</p></dd>


<dt>tau_threshold</dt>
<dd><p>Numeric; indicates the value of the Kendall's tau (Default: 0.05) for the independence copula</p></dd>


<dt>weights</dt>
<dd><p>Logical; weights for missing values (Default; <code>NA</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of matrix components:</p><ol><li><p><code>Params</code>: A \(d\times d\) strict upper triangular matrix including ML estimates</p></li>
<li><p><code>famsel</code>: A \(d\times d\) strict upper triangular matrix including the selected families based on the selection criteria</p></li>
<li><p><code>count</code>: A \(d\times d\) strict upper triangular matrix indicating 1 if correctly selected 0 otherwise</p></li>
<li><p><code>DepMeasure</code>: A \(d\times d\) strict upper triangular matrix containing estimates for dependence measures</p></li>
<li><p><code>ll_selected</code>: An upper triangular matrix that contains log-likelihood values for selected families</p></li>
<li><p><code>AIC_selected</code>: An upper triangular matrix that contains (averaged) AIC values for selected families</p></li>
<li><p><code>BIC_selected</code>: An upper triangular matrix that contains (averaged) BIC values for selected families</p></li>
<li><p><code>EffectSamp</code>: A \(d\times d\) strict upper triangular matrix containing effective sample sizes \(n_{D_e}\) for selected families</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kiriliouk, A., Lee, J., &amp; Segers, J. (2023). X-Vine Models for Multivariate Extremes. arXiv preprint arXiv:2312.15205.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">StrMtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">3</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,<span class="fl">5</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ParMtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,<span class="fl">5</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">FamMtx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                   <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,<span class="fl">5</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># X-vine specification</span></span></span>
<span class="r-in"><span><span class="va">XVS</span><span class="op">=</span><span class="fu"><a href="XVineSpec.html">XVineSpec</a></span><span class="op">(</span>M <span class="op">=</span> <span class="va">StrMtx</span>, Mmod <span class="op">=</span> <span class="va">FamMtx</span>, Mpar <span class="op">=</span> <span class="va">ParMtx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Pareto random samples</span></span></span>
<span class="r-in"><span><span class="va">Dat_P</span><span class="op">=</span><span class="fu"><a href="ParetoSim.html">ParetoSim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2000</span>, XVS <span class="op">=</span> <span class="va">XVS</span><span class="op">)</span> <span class="co"># Pareto scale</span></span></span>
<span class="r-in"><span><span class="co"># Specify the class of families</span></span></span>
<span class="r-in"><span><span class="va">familyset_tc</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">familyset_cop</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Sequential model selection of bivariate parametric families</span></span></span>
<span class="r-in"><span><span class="va">FamSelOut</span><span class="op">=</span><span class="fu">XVineFamSel</span><span class="op">(</span>data <span class="op">=</span> <span class="va">Dat_P</span>, Rank <span class="op">=</span> <span class="cn">TRUE</span>, qt <span class="op">=</span> <span class="fl">0.05</span>, XVS <span class="op">=</span> <span class="va">XVS</span></span></span>
<span class="r-in"><span>, famset_tc <span class="op">=</span> <span class="va">familyset_tc</span>, famset_cop <span class="op">=</span> <span class="va">familyset_cop</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jeongjin Lee, Anna Kiriliouk, Johan Segers.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

