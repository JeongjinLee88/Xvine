##  X-Vine specification
XVS=XVineSpec(M = StrMtx, Mmod = FamMtx, Mpar = ParMtx)
# Fit X-vine models (1. find the maximum spanning tree 2. perform family selection 3. estimate parameters 4. create plots)
Dat_P=ParetoSim(n = 2000, XVS = XVS) # Pareto scale
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = FALSE
, Rank_chiU = FALSE, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$ChiUPlot
Dat_P
Dat_Pa
Rank_chiL
Rank_chiL=FALSE
if(Rank_chiL){
# Empirical chi's vs Fitted chi's
emp_chimat <- ChiMtxMC(data) # already rank-based samples
emp_chimat <- emp_chimat[upper.tri(emp_chimat)]
XVine_chimat <- ChiMtxMC(FittedDat_P,quan = quan)
XVine_chimat <- XVine_chimat[upper.tri(XVine_chimat)]
}else{
# Model-based chi's vs Fitted chi's via Monte Carlo simulation
emp_chimat <- ChiMtxMC(1/Dat_Pa) # limiting samples from the specified inverted-MPD
emp_chimat <- emp_chimat[upper.tri(emp_chimat)]
XVine_chimat <- ChiMtxMC(1/FittedDat_P)
XVine_chimat <- XVine_chimat[upper.tri(XVine_chimat)]
}
XVS = NULL
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = FALSE
, Rank_chiU = FALSE, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$ChiUPlot
!is.null(XVS)
if(!is.null(XVS)){
Dat_Pa=ParetoSim(n = N, XVS = XVS)
}
Dat_Pa
Rank_chiL
if(Rank_chiL){
# Empirical chi's vs Fitted chi's
emp_chimat <- ChiMtxMC(data) # already rank-based samples
emp_chimat <- emp_chimat[upper.tri(emp_chimat)]
XVine_chimat <- ChiMtxMC(FittedDat_P,quan = quan)
XVine_chimat <- XVine_chimat[upper.tri(XVine_chimat)]
}else{
# Model-based chi's vs Fitted chi's via Monte Carlo simulation
emp_chimat <- ChiMtxMC(1/Dat_Pa) # limiting samples from the specified inverted-MPD
emp_chimat <- emp_chimat[upper.tri(emp_chimat)]
XVine_chimat <- ChiMtxMC(1/FittedDat_P)
XVine_chimat <- XVine_chimat[upper.tri(XVine_chimat)]
}
ChiLPlot <- ggplot() +
geom_point(aes(x = c(emp_chimat),y = c(XVine_chimat))) +
geom_abline(slope = 1, intercept = 0) +
labs(title="",x=expression(paste("Model"," ",chi)), y = expression(paste("Fitted"," ",chi))) +
theme(
axis.text.x = element_text(color = "black",face="bold", size=14),
axis.text.y = element_text(face="bold", size =14),
axis.title.x = element_text(color="black", size=14, face="bold"),
axis.title.y = element_text(color="black", size=14, face="bold"),
panel.background = element_rect(fill = "white",
colour = "white",
linewidth = 0.5, linetype = "solid"),
panel.grid.major = element_line(linewidth = 0.5, linetype = 'solid',
colour = "grey"),
panel.grid.minor = element_line(linewidth = 0.25, linetype = 'solid',
colour = "grey"),
plot.margin = margin(0.5, 0.5, 0.5, 0.5, "cm")) +
scale_x_continuous(n.breaks = 5)
ChiLPlot
emp_chimat
FlightDelay
# n=3603 d=29
XVineFlightOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiU = TRUE, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
load_all()
# n=3603 d=29
XVineFlightOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiU = TRUE, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFlightOut$ChiLPlot
XVineFlightOut$ChiUPlot
XVineFlightOut$VarioPlot
XVineFlightOut$TruncLevel_mBICmin
XVineFlightTruncOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiU = TRUE, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFlightTruncOut$ChiLPlot
HRXVineFlightOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiU = TRUE, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = TRUE, Vario_graph = TRUE, MST1_HR=TRUE, quan=0.13
, tcfamset = c(1), pcfamset = c(0,1)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
HRXVineFlightOut$ChiLPlot
HRXVineFlightOut$VarioPlot
HRXVineFlightOut$TruncLevel_mBICmin
ChiLPlot
ChiLPlot=NULL
XVS=NULL
# Fit X-vine models (1. find the maximum spanning tree 2. perform family selection 3. estimate parameters 4. create plots)
Dat_P=ParetoSim(n = 2000, XVS = XVS) # Pareto scale
Dat_P
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = XVS, Rank = FALSE
, Rank_chiU = FALSE, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = XVS, Rank = T
, Rank_chiU = T, Rank_chiL = T, Rank_chi3 = T
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$ChiUPlot
XVineFitOut$Chi3Plot
load_all()
XVineFlightTruncOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVS
XVineFlightTruncOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = TRUE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
!is.null(XVS)
is.true(Rank_chiL)
isTRUE(Rank_chiL)
isTRUE(Rank_chiL)
any(Rank_chiL,Rank_Vario,Rank_chi3)
Rank_chiL
Rank_chi3
Rank_chiL=FALSE
Rank_Vario=FALSE
Rank_chi3=TRUE
Rank_chiL
Rank_Vario
Rank_chi3
any(Rank_chiL,Rank_Vario,Rank_chi3)
all(Rank_chiL,Rank_Vario,Rank_chi3)
!all(Rank_chiL,Rank_Vario,Rank_chi3)
Rank_chiL
Rank_chiL=T
Rank_Vario=R
Rank_Vario=T
Rank_chi3
all(Rank_chiL,Rank_Vario,Rank_chi3)
!all(Rank_chiL,Rank_Vario,Rank_chi3)
Rank_chiL
Rank_Vario
Rank_chi3
all(Rank_chiL,Rank_Vario,Rank_chi3)
any(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE
Rank_chiL
Rank_Vario
Rank_chi3
any(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE
Rank_chiL=FALSE
any(Rank_chiL,Rank_Vario,Rank_chi3)
any(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE
any(c(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE)
any(c(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE)
Rank_chiL=T
any(c(Rank_chiL,Rank_Vario,Rank_chi3)==FALSE)
Rank_chiL
Rank_Vario
Rank_chi3
load_all()
StrMtx <- matrix(c(1, 1, 2, 2, 4,
0, 2, 1, 3, 2,
0, 0, 3, 1, 3,
0, 0, 0, 4, 1,
0, 0, 0, 0, 5),5,byrow = TRUE)
ParMtx <- matrix(c(0, 1.5, 2, 2.5, 2,
0, 0, 2, 2.5, 0.7,
0, 0, 0, 0.4, -0.3,
0, 0, 0, 0, 0.1,
0, 0, 0, 0, 0),5,byrow = TRUE)
FamMtx <- matrix(c(0, 1, 2, 3, 4,
0, 0, 3, 4, 1,
0, 0, 0, 3, 1,
0, 0, 0, 0, 1,
0, 0, 0, 0, 0),5,byrow = TRUE)
##  X-Vine specification
XVS=XVineSpec(M = StrMtx, Mmod = FamMtx, Mpar = ParMtx)
# Fit X-vine models (1. find the maximum spanning tree 2. perform family selection 3. estimate parameters 4. create plots)
Dat_P=ParetoSim(n = 2000, XVS = XVS) # Pareto scale
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = XVS, Rank = FALSE
, Rank_chiU = FALSE, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = XVS, Rank = FALSE
, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$ChiUPlot
XVineFitOut$Chi3Plot
XVineFitOut$mBIC_g
XVS = NULL
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = FALSE
, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
load()
load_all()
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$Chi3Plot
XVineFitOut$VarioPlot
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = TRUE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = TRUE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut=XVineModelFit(data = Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$Chi3Plot
XVineFitOut$VarioPlot
load_all()
check()
load_all()
check()
# 4. Fit truncated X-vine models at q=7
XVineFlightTruncOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = TRUE, Vario_graph = FALSE, quan=0.13
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFlightTruncOut$ChiLPlot
XVineFlightTruncOut$Chi3Plot
XVineFlightTruncOut$TruncLevel_mBICmin
# 5. Fit the truncated HR X-vine model at q=7
HRXVineFlightOut=XVineModelFit(data = FlightDelay, N = 3600, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = TRUE, Vario_graph = TRUE, MST1_HR=TRUE, quan=0.13
, tcfamset = c(1), pcfamset = c(0,1)
, selectioncrit = "AIC", trunclevel = 7, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
HRXVineFlightOut$ChiLPlot
HRXVineFlightOut$VarioPlot
# 2. Use rank-based samples
XVineFitOut2=XVineModelFit(data = Dat_P, N = 2000, XVS = NULL, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
# 2. Use rank-based samples
XVineFitOut2=XVineModelFit(data = Dat_P, N = 2000, XVS = XVS, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVS
StrMtx <- matrix(c(1, 1, 2, 2, 4,
0, 2, 1, 3, 2,
0, 0, 3, 1, 3,
0, 0, 0, 4, 1,
0, 0, 0, 0, 5),5,byrow = TRUE)
ParMtx <- matrix(c(0, 1.5, 2, 2.5, 2,
0, 0, 2, 2.5, 0.7,
0, 0, 0, 0.4, -0.3,
0, 0, 0, 0, 0.1,
0, 0, 0, 0, 0),5,byrow = TRUE)
FamMtx <- matrix(c(0, 1, 2, 3, 4,
0, 0, 3, 4, 1,
0, 0, 0, 3, 1,
0, 0, 0, 0, 1,
0, 0, 0, 0, 0),5,byrow = TRUE)
##  X-Vine specification
XVS=XVineSpec(M = StrMtx, Mmod = FamMtx, Mpar = ParMtx)
# 2. Use rank-based samples
XVineFitOut2=XVineModelFit(data = Dat_P, N = 2000, XVS = XVS, Rank = TRUE
, Rank_chiL = TRUE, Rank_chi3 = TRUE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut2$ChiLPlot
XVineFitOut2$mBIC_g
use_r("mBICplot.R")
use_r("XVineModelFit_lightversion.R")
Out=XVineModelFit_lightversion(data, Rank=TRUE, MST1_HR=FALSE, quan=0.2
, tcfamset = c(1,2,3,4), pcfamset = c(0,1,3,4,5,6,13,14,16), selectioncrit = "AIC"
, trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2= 'tau', si=0.9, effsampsize=10, tau_threshold=0.05, se=FALSE, weights=NA, cores = 1)
load_all()
Out=XVineModelFit_lightversion(data, Rank=TRUE, MST1_HR=FALSE, quan=0.2
, tcfamset = c(1,2,3,4), pcfamset = c(0,1,3,4,5,6,13,14,16), selectioncrit = "AIC"
, trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2= 'tau', si=0.9, effsampsize=10, tau_threshold=0.05, se=FALSE, weights=NA, cores = 1)
load_all()
Out=XVineModelFit_lightversion(data, Rank=TRUE, MST1_HR=FALSE, quan=0.2
, tcfamset = c(1,2,3,4), pcfamset = c(0,1,3,4,5,6,13,14,16), selectioncrit = "AIC"
, trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2= 'tau', si=0.9, effsampsize=10, tau_threshold=0.05, se=FALSE, weights=NA, cores = 1)
Out=XVineModelFit_lightversion(data, Rank=TRUE, MST1_HR=FALSE, quan=0.2,BIC_graph = FALSE
, tcfamset = c(1,2,3,4), pcfamset = c(0,1,3,4,5,6,13,14,16), selectioncrit = "AIC"
, trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2= 'tau', si=0.9, effsampsize=10, tau_threshold=0.05, se=FALSE, weights=NA, cores = 1)
Out=XVineModelFit_lightversion(data, Rank=TRUE, MST1_HR=FALSE, quan=0.2,BIC_graph = TRUE
, tcfamset = c(1,2,3,4), pcfamset = c(0,1,3,4,5,6,13,14,16), selectioncrit = "AIC"
, trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2= 'tau', si=0.9, effsampsize=10, tau_threshold=0.05, se=FALSE, weights=NA, cores = 1)
Out$mBIC_g
Out$TruncLevel_mBICmin
quan=1-seq(0.85,0.95,by=0.01)
quan
mBICplot(FlightDelay, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
load_all()
mBICplot(FlightDelay, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
mBICplot(Dat_P, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
load_all()
mBICplot(Dat_P, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
load_all()
mBICplot(Dat_P, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
quan
quan
1-quan
quan
quan=seq(0.05,0.15,by=0.01)
load_all()
mBICplot(Dat_P, Rank=TRUE, quan, famset_tc=c(1:4), famset_pc=c(0,1,3,4,5,6,13,14,16)
, selectioncrit="AIC",trunclevel=FALSE,treecritT1="chi",treecritT2="tau"
, effsampsize=10, tau_threshold=0.05, si=0.9)
load_all()
check()
load_all()
check()
load_all()
use_r("plotFlights_adj.R")
use_r("XVineFlightGraph.R")
use_r("XVineFlightGraphPerTree.R")
load_all()
check()
load_all()
check()
load_all()
check()
load_all()
check()
load_all()
check()
load_all()
check()
citation(package = "graphicalExtremes")
load_all()
check()
pkgdown::build_site()
# 3. Include github links in 'Description'
usethis::use_github_links()
use_git_remote(name="JeongjinLee88",url="https://github.com/JeongjinLee88/Xvine.git",overwrite = TRUE)
gitcreds::gitcreds_set()
pkgdown::clean_site()
pkgdown::build_site()
# 11. Get info about git_remotes
usethis::git_remotes()
?XVineModelFit
?XVineSeqEst
load_all()
check()
load_all()
check()
StrMtx <- matrix(c(1, 1, 2, 2, 4,
0, 2, 1, 3, 2,
0, 0, 3, 1, 3,
0, 0, 0, 4, 1,
0, 0, 0, 0, 5),5,byrow = TRUE)
ParMtx <- matrix(c(0, 1.5, 2, 2.5, 2,
0, 0, 2, 2.5, 0.7,
0, 0, 0, 0.4, -0.3,
0, 0, 0, 0, 0.1,
0, 0, 0, 0, 0),5,byrow = TRUE)
FamMtx <- matrix(c(0, 1, 2, 3, 4,
0, 0, 3, 4, 1,
0, 0, 0, 3, 1,
0, 0, 0, 0, 1,
0, 0, 0, 0, 0),5,byrow = TRUE)
##  X-Vine specification
XVS=XVineSpec(M = StrMtx, Mmod = FamMtx, Mpar = ParMtx)
# Pareto random samples
Dat_P=ParetoSim(n = 5000, XVS = XVS) # Pareto scale
# Sequential parameter estimation
SeqEstOut=XVineSeqEst(data = Dat_P, Rank = TRUE, qt = 0.05, XVS=XVS, method = 'mle')
# Specify the class of families
familyset_tc=c(1:4)
familyset_cop=c(0,1,3,4,5,6,13,14,16)
# Sequential model selection of bivariate parametric families
FamSelOut=XVineFamSel(data = Dat_P, Rank = TRUE, qt = 0.05, XVS = XVS
, famset_tc = familyset_tc, famset_cop = familyset_cop)
# Boxplot of dependence measures for X-vine models
BoxOut=XVineBoxplot(N = 2000, qt = 0.05, ite = 200, XVS = XVS, RankT = TRUE)
# Fit X-vine models (1. find the maximum spanning tree 2. perform family selection 3. estimate parameters 4. create plots)
# 1. Use samples from the limiting distribution
Dat_P=ParetoSim(n = 2000, XVS = XVS) # Pareto scale
XVineFitOut=XVineModelFit(data = 1/Dat_P, N = 2000, XVS = XVS, Rank = FALSE
, Rank_chiL = FALSE, Rank_chi3 = FALSE
, Chi3_graph = TRUE, Rank_Vario = FALSE, Vario_graph = FALSE
, tcfamset = c(1:4), pcfamset = c(0,1,3,4,5,6,13,14,16)
, selectioncrit = "AIC", trunclevel = FALSE, progress = TRUE
, treecritT1 = "chi", treecritT2 = "tau", effsampsize = 10, tau_threshold = 0.05
, weights = NA, cores=1)
XVineFitOut$ChiLPlot
XVineFitOut$Chi3Plot
XVineFitOut$mBIC_g
XVineFitOut$ChiLPlot
XVineFitOut$ChiLPlot
XVineFitOut$Chi3Plot
XVineFitOut$mBIC_g
